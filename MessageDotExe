$TargetDayOfMonth = 3
$targetTime = Get-Date -Hour 15 -Minute 05 -Format "yyyyMMddHHmm"

#Loop forever while the computer is running

$TodaysDay = Get-date -Format "dd"

#loop until current time = target time

# Loop until the current time equals the target time
  while ((Get-Date -Format "yyyyMMddHHmm") -ne $TargetTime)  {
    Write-Host Get-Date -Format "yyyyMMddHHmm" + " " + $targetTime
    Start-Sleep -Seconds 15
  } 

msg.exe * /v /w Your computer will restart tonight to apply Windows Updates. Please save your work and log out before leaving.  If you do not want to restart, call the Helpdesk at (208)-992-5112 or send an email to Helpdesk@Youthranch.org
